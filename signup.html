<!DOCTYPE html>
  <html lang="ar" dir="rtl">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>ุฅูุดุงุก ุญุณุงุจ</title>
      <link rel="stylesheet" href="css/signup.css">
      <link rel="icon" href="icons8-business-intelligence-64.png" type="image/png">
    </head>
    <body class="login-page">

      <main class="form-container">
        <h2>๐ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h2>
        <form id="signup-form">
          <input id="signup-username" type="text" placeholder="ุงุณู ุงููุณุชุฎุฏู" required>
          <input id="signup-email" type="email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" required>
          <input id="signup-password" type="password" placeholder="ูููุฉ ุงููุฑูุฑ" required>
          <button type="submit" id="signupBtn">ุฅูุดุงุก ุญุณุงุจ</button>
          <div id="signupStatus" class="status-message"></div>
        </form>
        <p class="switch-page">ูู ูุฏูู ุญุณุงุจุ <a href="login.html">ุชุณุฌูู ุงูุฏุฎูู</a></p>
      </main>

      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
      <script src="js/firebase-config.js"></script>

      <script>
        document.getElementById("signup-form").addEventListener("submit", (e) => {
          e.preventDefault();

          const username = document.getElementById("signup-username").value.trim();
          const email = document.getElementById("signup-email").value.trim();
          const password = document.getElementById("signup-password").value;

          if (!username || !email || !password) {
            document.getElementById("signupStatus").innerText = "โ ูู ูุถูู ุฃููู ูู ุงูุญููู.";
            return;
          }

          firebase.auth().createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
              const user = userCredential.user;

              // ๐ข ุชุญุฏูุซ ุงูุงุณู
              return user.updateProfile({
                displayName: username
              }).then(() => {
                // ๐ข ุญูุธ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุงู
                return firebase.database().ref("users/" + user.uid).set({
                  username: username,
                  email: email
                });
              });
            })
            .then(() => {
              document.getElementById("signupStatus").innerText = "โ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ!";
              setTimeout(() => {
                window.location.href = "profile.html";
              }, 1000);
            })
            .catch((error) => {
              document.getElementById("signupStatus").innerText = "โ " + error.message;
            });
        });
      </script>
    </body>
  </html>